FROM tomcat:9-jdk14-openjdk-buster

MAINTAINER vincent.fazio@csiro.au

ARG war_file=target/AuScope-Portal-API-5.2.0-SNAPSHOT.war

ADD ${war_file} /usr/local/tomcat/webapps/AuScope-Portal-API.war

RUN rm -rf /usr/local/tomcat/webapps/ROOT \
  && unzip /usr/local/tomcat/webapps/AuScope-Portal-API.war -d /usr/local/tomcat/webapps/ROOT \
  && rm /usr/local/tomcat/webapps/AuScope-Portal-API.war \
  && cp /usr/local/tomcat/webapps/ROOT/WEB-INF/classes/application.yaml.default /usr/local/tomcat/webapps/ROOT/WEB-INF/classes/application.yaml

# ADD application.yaml /usr/local/tomcat/webapps/ROOT/WEB-INF/classes/
